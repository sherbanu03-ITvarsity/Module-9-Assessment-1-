<!DOCTYPE html>
<html>
<head>
    <title>Countdown Timer</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    </head>
    
    <body>
        <div class="container">
        <svg id="progressBarContainer" width="144" height="300">
        <defs>
           <pattern id="pattern1" x="0" y="0" width="12" height="12" patternUnits="userSpaceOnUse">
               <circle cx="5" cy="5" r="3" stroke="0" fill="white"/>
            </pattern> 
            </defs>
            <rect id="progressBar" x="0" y="0" width="144" height="300" style="fill:url(#pattern1);"/>
            </svg>
            
            <div id="clock">
                <p>Ready!</p>  
            </div>
            
        <div id="content">
            <select class="selector" id="hours">
            <option value="0">0 hours</option>
            <option value="1">1 hours</option>
            <option value="2">2 hours</option>
            <option value="3">3 hours</option>
            <option value="4">4 hours</option>
            <option value="5">5 hours</option>
            <option value="6">6 hours</option>
            <option value="7">7 hours</option>
            <option value="8">8 hours</option>
            <option value="9">9 hours</option>
            <option value="10">10 hours</option>
            <option value="11">11 hours</option>
            <option value="12">12 hours</option>
            <option value="13">13 hours</option>
            <option value="14">14 hours</option>
            <option value="15">15 hours</option>
            <option value="16">16 hours</option>
            <option value="17">17 hours</option>
            <option value="18">18 hours</option>
            <option value="19">19 hours</option>
            <option value="20">20 hours</option>
            <option value="21">21 hours</option>
            <option value="22">22 hours</option>
            <option value="23">23 hours</option>     
            </select>   
            
             <select class="selector" id="minutes">
            <option value="0">0 mins</option>
            <option value="1">1 mins</option>
            <option value="2">2 mins</option>
            <option value="3">3 mins</option>
            <option value="4">4 mins</option>
            <option value="5">5 mins</option>
            <option value="6">6 mins</option>
            <option value="7">7 mins</option>
            <option value="8">8 mins</option>
            <option value="9">9 mins</option>
            <option value="10">10 mins</option>
            <option value="11">11 mins</option>
            <option value="12">12 mins</option>
            <option value="13">13 mins</option>
            <option value="14">14 mins</option>
            <option value="15">15 mins</option>
            <option value="16">16 mins</option>
            <option value="17">17 mins</option>
            <option value="18">18 mins</option>
            <option value="19">19 mins</option>
            <option value="20">20 mins</option>
            <option value="21">21 mins</option>
            <option value="22">22 mins</option>
            <option value="23">23 mins</option>  
            <option value="24">24 mins</option>
            <option value="25">25 mins</option>
            <option value="26">26 mins</option>
            <option value="27">27 mins</option>
            <option value="28">28 mins</option>
            <option value="29">29 mins</option>
            <option value="30">30 mins</option>
            <option value="31">31 mins</option>
            <option value="32">32 mins</option>
            <option value="33">33 mins</option>
            <option value="34">34 mins</option>
            <option value="35">35 mins</option>
            <option value="36">36 mins</option>
            <option value="37">37 mins</option>
            <option value="38">38 mins</option>
            <option value="39">39 mins</option>
            <option value="40">40 mins</option>
            <option value="41">41 mins</option>
            <option value="42">42 mins</option>
            <option value="43">43 mins</option>
            <option value="44">44 mins</option>
            <option value="45">45 mins</option>
            <option value="46">46 mins</option>
            <option value="47">47 mins</option> 
            <option value="48">48 mins</option>
            <option value="49">49 mins</option>
            <option value="50">50 mins</option>
            <option value="51">51 mins</option>
            <option value="52">52 mins</option>
            <option value="53">53 mins</option>
            <option value="54">54 mins</option>
            <option value="55">55 mins</option>
            <option value="56">56 mins</option>
            <option value="57">57 mins</option>
            <option value="58">58 mins</option>
            <option value="59">59 mins</option>
            </select>
            
        <select class="selector" id="seconds">
            <option value="0">0 sec</option>
            <option value="1">1 sec</option>
            <option value="2">2 secs</option>
            <option value="3">3 secs</option>
            <option value="4">4 secs</option>
            <option value="5">5 secs</option>
            <option value="6">6 secs</option>
            <option value="7">7 secs</option>
            <option value="8">8 secs</option>
            <option value="9">9 secs</option>
            <option value="10">10 secs</option>
            <option value="11">11 secs</option>
            <option value="12">12 secs</option>
            <option value="13">13 secs</option>
            <option value="14">14 secs</option>
            <option value="15">15 secs</option>
            <option value="16">16 secs</option>
            <option value="17">17 secs</option>
            <option value="18">18 secs</option>
            <option value="19">19 secs</option>
            <option value="20">20 secs</option>
            <option value="21">21 secs</option>
            <option value="22">22 secs</option>
            <option value="23">23 secs</option>  
            <option value="24">24 secs</option>
            <option value="25">25 secs</option>
            <option value="26">26 secs</option>
            <option value="27">27 secs</option>
            <option value="28">28 secs</option>
            <option value="29">29 secs</option>
            <option value="30">30 secs</option>
            <option value="31">31 secs</option>
            <option value="32">32 secs</option>
            <option value="33">33 secs</option>
            <option value="34">34 secs</option>
            <option value="35">35 secs</option>
            <option value="36">36 secs</option>
            <option value="37">37 secs</option>
            <option value="38">38 secs</option>
            <option value="39">39 secs</option>
            <option value="40">40 secs</option>
            <option value="41">41 secs</option>
            <option value="42">42 secs</option>
            <option value="43">43 secs</option>
            <option value="44">44 secs</option>
            <option value="45">45 secs</option>
            <option value="46">46 secs</option>
            <option value="47">47 secs</option> 
            <option value="48">48 secs</option>
            <option value="49">49 secs</option>
            <option value="50">50 secs</option>
            <option value="51">51 secs</option>
            <option value="52">52 secs</option>
            <option value="53">53 secs</option>
            <option value="54">54 secs</option>
            <option value="55">55 secs</option>
            <option value="56">56 secs</option>
            <option value="57">57 secs</option>
            <option value="58">58 secs</option>
            <option value="59">59 secs</option>
            </select>
            
            </div>
            
            <div class="buttonSection">
            <div class="button1">
                <button class="roundButton" id="start">Start</button>
                </div>
            <div class="button2">
                <button class="roundButton" id="cancel">Cancel</button>
                </div>
            </div>
            
        </div>
        
    <script>
        
        document.getElementById("start").addEventListener('click' , startTimer);
        document.getElementById("cancel").addEventListener('click' , cancelledBtnPressed);
        
        var startTime;
        var endTime;
        var origTimePeriod;
        var newTimePeriod;
        var timer;
        var cancelled =false; 
        
        function startTimer(){
            cancelled = false;
            startTime = new Date();
            endTime =  getEndTime();
            
            origTimePeriod = endTime.getTime() - startTime.getTime();
            newTimePeriod = origTimePeriod;
            
            console.log(startTime + " : "  + endTime + " : " + origTimePeriod);
            
            timer = setInterval(displayCountdown, 1000);
        }
        
        function displayCountdown(){
            var timeLeft = msToTime(newTimePeriod);
            
            document.getElementById ("clock").innerHTML = `<p>${timeLeft["hours"]}h ${timeLeft["minutes"]}m ${timeLeft["seconds"]}s</p>`;
            
            var newHeight = Math.floor(newTimePeriod / origTimePeriod * 100) *3;
            document.getElementById("progressBar").setAttribute("height", newHeight);
            
            newTimePeriod -= 1000;
            
            if (newTimePeriod <0 || cancelled){
                clearInterval(timer);
                document.getElementById ("clock").innerHTML ="<p>Times Up!</p>"
            }
        }
        
        function cancelledBtnPressed(){
            cancelled= true;
        }
        
        function msToTime(milliseconds) {
            var mHour = 1000 * 60 *60;
            var mMinute = 1000*60;
            var mSecond = 1000;
            
            var hours = Math.floor (milliseconds / mHour);
            var minutes = Math.floor ((milliseconds % mHour) / mMinute);
            var seconds = Math.floor ((milliseconds % mMinute) /mSecond);
            
            var time = [];
            time ["hours"] = hours;
            time ["minutes"] = minutes;
            time ["seconds"] = seconds;
            
            return time;
            
        }
        
        function getEndTime(){
            var dt = new Date();
            
            var hours = parseInt (document.getElementById("hours").value);
            var minutes = parseInt (document.getElementById("minutes").value);
            var seconds = parseInt (document.getElementById("seconds").value);
           
            dt.setHours(dt.getHours() + hours);
            dt.setMinutes(dt.getMinutes() + minutes);
            dt.setSeconds(dt.getSeconds() + seconds);
            return dt;
        }
        
        
        </script>
    </body>
</html>